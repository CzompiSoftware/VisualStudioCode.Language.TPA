{
	"information_for_contributors":[
		
	],
	"version":"",
	"name":"TPA file",
	"scopeName":"source.tpafile",
	"patterns":[
		{
			"include":"#commands"
		},
		{
			"include":"#parameters"
		},
		{
			"include":"#geometry_item"
		},
		{
			"include":"#comments"
		},
		{
			"include":"#constants"
		},
		{
			"include":"#controls"
		},
		{
			"include":"#escaped_characters"
		},
		{
			"include":"#labels"
		},
		{
			"include":"#numbers"
		},
		{
			"include":"#operators"
		},
		{
			"include":"#parens"
		},
		{
			"include":"#strings"
		},
		{
			"include":"#variables"
		}
	],
	"repository":{
		"operators":{
			"patterns":[
				{
					"match":"(?>(?<=(end )|))(CGeomGlyphTTFvar|CGeomGlyphTTF|CGeomArc|CGeomRoot|CGeomRefLst|CGeomPoly|CGeomImptAI|signalList|file header)(?(1)(?!))",
					"name":"entity.name.type"
				}
			]
		},
		"parameters":{
			"patterns":[
				{
					"match":"(?<=^|\\s)((?i)(CODE_39|PGRH|OFF|OUT|POSA|PTFTP_DIFF1|bc|BSZ_SRC|BTR_ED_FS1|CODE_2_5_I|DD_MM_YY|DMOUT_CL|EDGE_GRAVE|EDGE_HATCH|CONTAINER|EDGE_HATCH|EDGE_POINT|EDGE_SCALE|HH_MM|OFF|DMSZ_MX))(?=.*)",
					"name":"variable.parameter"
				},
				{
					"match":"(?<=^|\\s|=)((?i)(BMPCR|BMPSM|BMPTR|BMP|BPC|BPFLG|BPHGT|BPI|BPOFF|BP|CI|DMI|DMOFF|DMOUT|DMSZ|HATCH|lfai|PA|PGRC|QU|TLFNT|TTFNT|TTRH|TTR|TXANG|TXFLG|TXHGT|TXVAR|WF|WOB))(?=.*)",
					"name":"variable.parameter"
				}
			]
		},
		"geometry_item":{
			"patterns":[
				{
					"match":"((\/\/{{( end(.*|)|))|(::|,|;))",
					"name":"storage.type.struct"
				}
			]
		},
		"numbers":{
			"patterns":[
				{
					"match":"(?<=^|\\s|=)(0[xX][0-9A-Fa-f]*|[+-]?\\d+)(?=$|\\s|,|;|<|>| )",
					"name":"constant.numeric.tpafile"
				},
				{
					"match":"(?<=^|\\s|=)([0-9A-Fa-f]*|[+-]?\\d+)(|\\.([0-9A-Fa-f]*|[+-]?\\d+))(?=$|\\s|,|;|<|>| )",
					"name":"constant.numeric.tpafile"
				},
				{
					"match":"(?<=^|\\s)((?i)(l|r|bl|br|PP_CIRCARC|PP_IMP_AI|PP_RECT|PP_TEXT|pz))(?=.*)",
					"name":"constant.numeric.tpafile"
				}
				
			]
		},
		"comments":{
			"patterns":[
				{
					"match":"(\/\\*(.*)(\\*\/|\n))",
					"name":"comment.line.tpafile"
				}
			]
		},
		"strings":{
			"patterns":[
				{
					"begin":"\"",
					"beginCaptures":{
						"0":{
							"name":"punctuation.definition.string.begin.tpafile"
						}
					},
					"end":"(\")|(\\n)",
					"endCaptures":{
						"1":{
							"name":"punctuation.definition.string.end.tpafile"
						},
						"2":{
							"name":"invalid.illegal.newline.tpafile"
						}
					},
					"name":"string.quoted.double.tpafile",
					"patterns":[
						{
							"match":"%%",
							"name":"constant.character.escape.tpafile"
						},
						{
							"include":"#variables"
						}
					]
				}
			]
		},
		"variables":{
			"patterns":[
				{
					"match":"(%)((~([fdpnxsatz]|\\$PATH:)*)?\\d|\\*)",
					"captures":{
						"1":{
							"name":"punctuation.definition.variable.tpafile"
						},
						"2":{
							"name":"variable.parameter.tpafile"
						}
					}
				},
				{
					"include":"#variable"
				},
				{
					"include":"#variable_delayed_expansion"
				}
			]
		},
		"variable":{
			"patterns":[
				{
					"begin":"%(?=[^%]+%)",
					"beginCaptures":{
						"0":{
							"name":"punctuation.definition.variable.begin.tpafile"
						}
					},
					"end":"(%)|\\n",
					"endCaptures":{
						"1":{
							"name":"punctuation.definition.variable.end.tpafile"
						}
					},
					"name":"variable.other.readwrite.tpafile",
					"patterns":[
						{
							"begin":":~",
							"beginCaptures":{
								"0":{
									"name":"punctuation.separator.tpafile"
								}
							},
							"end":"(?=%|\\n)",
							"name":"meta.variable.substring.tpafile",
							"patterns":[
								{
									"include":"#variable_substring"
								}
							]
						},
						{
							"begin":":",
							"beginCaptures":{
								"0":{
									"name":"punctuation.separator.tpafile"
								}
							},
							"end":"(?=%|\\n)",
							"name":"meta.variable.substitution.tpafile",
							"patterns":[
								{
									"include":"#variable_replace"
								},
								{
									"begin":"=",
									"beginCaptures":{
										"0":{
											"name":"punctuation.separator.tpafile"
										}
									},
									"end":"(?=%|\\n)",
									"patterns":[
										{
											"include":"#variable_delayed_expansion"
										},
										{
											"match":"[^%]+",
											"name":"string.unquoted.tpafile"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		"variable_delayed_expansion":{
			"patterns":[
				{
					"begin":"!(?=[^!]+!)",
					"beginCaptures":{
						"0":{
							"name":"punctuation.definition.variable.begin.tpafile"
						}
					},
					"end":"(!)|\\n",
					"endCaptures":{
						"1":{
							"name":"punctuation.definition.variable.end.tpafile"
						}
					},
					"name":"variable.other.readwrite.tpafile",
					"patterns":[
						{
							"begin":":~",
							"beginCaptures":{
								"0":{
									"name":"punctuation.separator.tpafile"
								}
							},
							"end":"(?=!|\\n)",
							"name":"meta.variable.substring.tpafile",
							"patterns":[
								{
									"include":"#variable_substring"
								}
							]
						},
						{
							"begin":":",
							"beginCaptures":{
								"0":{
									"name":"punctuation.separator.tpafile"
								}
							},
							"end":"(?=!|\\n)",
							"name":"meta.variable.substitution.tpafile",
							"patterns":[
								{
									"include":"#escaped_characters"
								},
								{
									"include":"#variable_replace"
								},
								{
									"include":"#variable"
								},
								{
									"begin":"=",
									"beginCaptures":{
										"0":{
											"name":"punctuation.separator.tpafile"
										}
									},
									"end":"(?=!|\\n)",
									"patterns":[
										{
											"include":"#variable"
										},
										{
											"match":"[^!]+",
											"name":"string.unquoted.tpafile"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		"variable_replace":{
			"patterns":[
				{
					"match":"[^=%!\\n]+",
					"name":"string.unquoted.tpafile"
				}
			]
		},
		"variable_substring":{
			"patterns":[
				{
					"match":"([+-]?\\d+)(?:(,)([+-]?\\d+))?",
					"captures":{
						"1":{
							"name":"constant.numeric.tpafile"
						},
						"2":{
							"name":"punctuation.separator.tpafile"
						},
						"3":{
							"name":"constant.numeric.tpafile"
						}
					}
				}
			]
		}
	}
}
